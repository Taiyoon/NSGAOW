## **混合云中考虑隐私偏好的任务调度模型（XXX,XXX）**

---

### **1. 混合云架构**
- **资源池**：  
  - **私有云资源池** \( \mathcal{S} \)：  
    - 包含 \( S \) 台异构虚拟机，记为 \( \mathcal{S} = \{s_1, s_2, ..., s_S\} \)，下标为 \( i \in \{1, 2, ..., S\} \)。  
    - 可以存储隐私数据，具体存储方式在"2. 考虑隐私偏好的隐私数据管理系统"中定义。

  - **公有云资源池** \( \mathcal{V} \)：  
    - 包含 \( J \) 种可租用虚拟机类型，记为 \( \mathcal{J} = \{1, 2, ..., J\} \)，每种类型 \( j \in \mathcal{J} \) 有 \( N_j \) 个实例。  
    - 虚拟机实例表示为 \( v_{j,n} \) ，其中 \( j \) 为类型，\( n \in \{1, 2, ..., N_j\} \) 为实例编号。  
    - 租用成本为 \( R_j \)（货币单位/秒），由云服务商定价，与类型 \( j \) 的计算能力正相关。  

- **计算能力**：  
  - **私有云虚拟机**：每台 \( s_i \) 的计算能力为 \( A_i \)（兆赫兹, MHz），即每秒执行 \( A_i \times 10^6 \) 次运算。  
  - **公有云虚拟机**：类型 \( j \) 的计算能力为 \( B_j \)（MHz），实例 \( v_{j,n} \) 的计算能力为 \( B_j \)。  
- **网络模型**：
  - 私有云与公有云间带宽固定为 \( \beta_{\text{net}} \)（兆比特/秒, Mbps）。  

- **成本模型**：  
  - **私有云运行成本**：以固定基础设施成本为主，与任务调度无关。  
  - **公有云运行成本**：动态成本，与虚拟机实例运行时间成正比：  
    \[
    \text{Cost}_{\text{public}} = \sum_{j=1}^J \sum_{n=1}^{N_j} R_j \cdot T_{(j,n)}
    \]
    - 运行时间 \( T_{(j,n)} \) 定义为实例 \( v_{j,n} \) 的最晚任务完成时间：  
      \[
      T_{(j,n)} = \max_{t \in T} \left( \text{FinishTime}(t) \cdot \mathbf{Y}[t][(j,n)] \right)
      \]
      *其中 \( \mathbf{Y}[t][(j,n)] \in \{0,1\} \) 表示任务 \( t \) 是否分配至实例 \( v_{j,n} \)。*

### **2. 任务模型**

#### **2.1 任务符号**
  - **任务集合**：\( \mathcal{E} = \{e_1, e_2, ..., e_M\} \)，任务总量为 \( M \)，任务下标为 \( m \)。  
  - **关联隐私数据**：每个任务 \( e_m \) 需处理隐私数据 \( d_k \in \mathcal{D} \)。本文定义任务所需的隐私数据为 \( \text{data}(e_m) \in \mathcal{D} \)  

#### **2.2 任务类型**
1. **独立任务**  
   - **定义**：完全在私有云执行的任务 \( e_m \)，是在最高安全策略（\( \alpha = 1.0 \)）情况下唯一的任务执行方式。  
2. **协作任务**  
   - **建模方法**：需跨私有云与公有云协作处理的任务，通过线性工作流\cite{stavrinidesMulticriteriaSchedulingLinear2021}（Linear Workflow, LW）建模。  
   - **线性工作流（LW）结构**：  
     每个协作任务 \( e_j \) 由三个**顺序执行**的子任务构成：  
     \[
     e_m = \{ e_m^{\text{(E)}}, e_m^{\text{(P)}}, e_m^{\text{(V)}} \}
     \]
     1. **加密子任务（Encrypt, E）**：在私有云完成输入数据加密与传输。  
     2. **处理子任务（Process, P）**：在公有云完成解密、计算、与加密回传。  
     3. **验证子任务（Verify, V）**：在私有云完成完整性校验。  

#### **2.4 混合调度示例**  
- **场景**：1台私有云 \( s_1 \)，1台公有云 \( v_1 \)。  
- **任务实例**：  
  - **两个协作任务 \( e_1, e_3 \)**：  
    \[
    e_1 = \{ e_1^{\text{(E)}}, e_1^{\text{(P)}}, e_1^{\text{(V)}} \}, \quad e_3 = \{ e_3^{\text{(E)}}, e_3^{\text{(P)}}, e_3^{\text{(V)}} \}
    \]
  - **一个独立任务 \( e_2 \)**：全程在私有云 \( s_1 \) 执行。  
- **执行顺序**（如图3所示）**：  
  - **私有云 \( s_1 \)**：  
    \[
    e_1^{\text{(E)}} \rightarrow e_2 \rightarrow e_3^{\text{(E)}} \rightarrow e_1^{\text{(V)}} \rightarrow e_3^{\text{(V)}}
    \]
  - **公有云 \( v_1 \)**：  
    \[
    e_1^{\text{(P)}} \rightarrow e_3^{\text{(P)}} 
    \]

---

#### **图3. 混合调度时序图（文本描述）**  
```plaintext
私有云 s₁ 时间轴：

CPU：XXX
网络：XXX

公有云 v₁ 时间轴：

CPU：XXX
网络：XXX

```

##### **2.2 任务执行时间**
- **决策变量**
  1. **私有虚拟机分配**：  
     - 定义决策矩阵 \( \mathbf{X} \in \{0, 1\}^{S \times M} \)，其中 \( \mathbf{X}[i][m] = 1 \) 表示任务 \( e_m \) 分配至私有云虚拟机 \( s_i \)。  
  2. **公有虚拟机分配**：  
     - 定义决策变量 \( \mathbf{Y} \in \{0, 1\}^{N \times M} \)，其中 \( \mathbf{Y}[j][m] = 1 \) 表示协作任务 \( e_m \) 的处理子任务 \( e_m^\text{(P)} \)分配至分配至公有云 \( v_j \)。  
  3. **安全策略选择**：  
     - 定义决策矩阵 \( \mathbf{Z} \in \{\text{Pref}(d_k) \}^{Q \times M} \)，其中 \( \mathbf{Z}[q][m] = 1 \) 表示任务 \( e_m \) 选择安全策略 \( \text{Pref}(\text{data}(e_m))\text{-}q \)，其影响着任务的加解密开销、任务的执行方式（独立/协作）、以及混合云系统安全性。  

- 协作任务
  - e_1\text{-E}
    - 开始时间
    - 完成时间
  - e_1\text{-E}
    - 开始时间
    - 完成时间
  - e_1\text{-E}
    - 开始时间
    - 完成时间
- 独立任务
    - 开始时间
    - 完成时间
- 完工时间（

由于执行顺序可以唯一确定，这个优化模型可以方便地迁移到实际在线调度环境中。

### **3. 考虑隐私偏好的隐私数据管理系统**
#### **1. 数据定义**
  - **数据标识**：  
     - 数据集 \( \mathcal{D} = \{d_1, d_2, ..., d_K\} \)，\( K \) 为数据总量，\( d_k \) 表示第 \( k \) 条数据。  
  - **存储位置**：  
    - 二元矩阵 \( \mathbf{L} \in \{0,1\}^{K \times S} \)，定义数据在私有云的分布：  
      \[
      \mathbf{L}[k][i] = 
      \begin{cases} 
      1, & \text{数据 } d_k \text{ 存储在私有云虚拟机 } s_i \\
      0, & \text{否则}
      \end{cases}
      \]
      - **示例**：  
        数据 \( d_1 \) 存储在 \( s_1, s_2 \)，\( d_2 \) 存储在 \( s_3 \)，则：  
        \[
        \mathbf{L} = \begin{bmatrix}
        1 & 1 & 0 \\
        0 & 0 & 1 
        \end{bmatrix}
        \]
  - **数据属性**：  

   | 属性    | 符号   | 描述  |
   |---------|--------|-------|
   | 数据大小| \( \text{size}(d_k) \) | 数据大小（MB），决定存储与传输开销。    |
   | 最低安全需求       | \( \alpha_{\min}(d_k) \) | 管理者设定的最低安全阈值 \( \in [0,1] \)。        |
   | 隐私偏好       | \( \text{Pref}(d_k) \) | 合规性标签（如国标、NIST、GDPR），仅为偏好的一种可能实现形式。|
   | 脆弱性  | \( V(d_k) \)      | 动态风险指标 \( \in [0,1] \)，初始为0。          |

#### 2. **考虑隐私偏好安全策略库**
   1. **策略设计原则**  
      - 隐私偏好可基于**合规性要求**（如行业标准、组织规范），本文以数据主权合规为例，支持以下三类标签：  
        - **Pref=1**：满足国家密码标准的算法组合（如SM4+SM3）。  
        - **Pref=2**：满足NIST标准的算法组合（如AES-256+SHA-3）。  
        - **Pref=3**：满足欧盟通用数据保护标准的算法组合（如AES-256+SHA-512）。  
   3. **策略库结构**  
        - 每个隐私偏好 \( \text{Pref}=p \) 对应一个独立策略库，库内策略编号为 \( \text{Pref}p\text{-}q \)，其中 \( q \in \{1, ..., Q_p\} \)。  
        - \( Q_p \) 表示偏好 \( p \) 的策略总数（如 Pref=1 的 \( Q_1=3 \)）。  
        - 为了简化调度，我们约定本文三种策略库中安全策略数量相同；每种策略的安全等级随编号增加而下降，而加解密开销随编号增加而上升（这是很自然的约定，因为安全等级低但开销大的安全策略不应该被选入安全策略库）。每个策略库中都有编号 q=0 ，也就是在私有云内处理的安全策略。

   4. **策略库示例（Pref=1）**  
     
   | 安全策略         | 编号 \( m \)    | 安全等级 | 总开销 (Cycle/Byte) | 适用场景          |
   |------------------|----------------|----------|---------------------|-------------------|
   | 私有云内处理      | Pref1-0        | 1.0      | 0.0                 | 高敏感数据         |
   | SM4+SM3          | Pref1-1        | 0.89     | 0.54                | 金融与政务场景     |
   | AES-256+SHA-256   | Pref1-2        | 0.82     | 0.82                | 跨境数据交换       |

   *注：完整策略库包含所有标签（Pref=1,2,3）的详细配置，见附录表A。*  

   5. **策略选择规则**  
      1. **合规性约束**：任务必须选择符合数据隐私偏好 \( \text{Pref}(d_k) \) 的策略。  
      2. **安全需求约束**：策略安全等级需满足 \( \alpha \geq \alpha_{\min}(d_k) \)。  

#### **3. 脆弱性更新机制**
1. **初始设置**  
   - **历史安全等级**：所有数据初始安全等级为 \( \alpha_{\text{hist}}(d_k) = 1.0 \)，对应私有云内处理的最高安全性。  
   - **脆弱性评分**：初始脆弱性 \( V(d_k) = 0 \)，表示初始无风险。  

2. **更新规则**  
   1. **安全升级或持平**（\( \alpha_{\text{now}} \geq \alpha_{\text{hist}} \)）：  
      - **脆弱性不变**：\( V_{\text{new}}(d_k) = V_{\text{prev}}(d_k) \)。  
      - **历史等级保持**：\( \alpha_{\text{hist}} \) 不更新。  

   2. **安全降级**（\( \alpha_{\text{now}} < \alpha_{\text{hist}} \)）：  
      - **风险增量计算**：  
        \[
        \Delta V = \alpha_{\text{hist}} - \alpha_{\text{now}}
        \]
      - **脆弱性更新**：  
        \[
        V_{\text{new}}(d_k) = \min\left( V_{\text{prev}}(d_k) + \Delta V, 1 \right)
        \]
      - **历史等级更新**：  
        \[
        \alpha_{\text{hist}} = \alpha_{\text{now}}
        \]
3. **设计目的与优势**  
   1. **弹性安全策略**：  
       - **低负载时**：优先选择高安全策略（如私有云处理），最大化数据保护。  
       - **高负载时**：通过“优雅降级”选择低开销策略（如轻量级加密），提升任务吞吐量（需要额外说明：安全性与开销成正比，安全性越高，开销越大，还要引用文献加强说服力）。
   2. **可审计**
       - 脆弱性 \( V(d_k) \) 显式反映数据因降级操作累积的风险，为系统优化提供可解释信号。  

#### **4. 系统安全性优化目标（未修正）**
   1. **决策变量**Z[m][q]
   2. **数据安全价值**  
      \[
      p(d_k) = \text{size}(d_k) \times \alpha_{\min}(d_k)
      \]
      *含义*：数据价值与其体积和最低安全需求正相关（引用 [1]）。  

   3. **系统整体安全性（优化目标）**  
      \[
      S = \sum_{k=1}^K p(d_k) \cdot \left( 1 - V(d_k) \right)
      \]

---

#### **4. 优化问题形式化（未考虑）**
##### **4.1 决策变量**
1. **决策变量**  
   - 任务分配 \( \mathbf{X} \in \{0,1\}^{K \times M} \)、\( \mathbf{Y} \in \{0,1\}^{K \times N} \)。  \( x_{t,i} \in \{0,1\} \)：任务 \( t \) 是否分配至私有云虚拟机 \( s_i \)。  \( y_{t,j} \in \{0,1\} \)：任务 \( t \) 是否分配至公有云虚拟机 \( v_j \)。  
   - 加密算法选择矩阵 \( \mathbf{A}_{\text{in}}, \mathbf{A}_{\text{out}} \in \{0,1\}^{K \times A} \)。  \( a_t \in A \)：任务 \( t \) 选用的加密算法。  
2. **优化目标**  
   - **目标1**：最小化总时延 \( \sum \text{Latency}(t) \)。  
   - **目标2**：最大化系统安全性 \(
\text{Maximize } S = \sum_{d \in D} p(d) \times \left(1 - V(d)\right)
\)  

3. **约束条件**  
   1. **最低安全需求约束**：  
   2. **资源容量约束**：  


##### **4.2 目标函数**
**双目标优化**：  
\[
\text{Minimize } \sum_{t \in T} \text{Latency}(t) \quad \text{(最小化总时延)}
\]
\[
\text{Maximize } S = \sum_{d \in D} p(d) \times (1 - V(d)) \quad \text{(最大化系统安全性)}
\]

##### **4.3 约束条件**
1. **资源分配**：  
   \[
   \sum_{t \in T} x_{t,i} \leq c_i \quad \forall s_i \in S_{\text{private}}, \quad \sum_{t \in T} y_{t,j} \leq c_j \quad \forall v_j \in S_{\text{public}}
   \]
2. **安全需求**：  
   \[
   \alpha(a_t) \geq \alpha_{\min}(d_t) \quad \forall t \in T
   \]
3. **隐私偏好**：  
   \[
   a_t \in \text{Pref}(d_t) \quad \forall t \in T
   \]
4. **脆弱性更新**：根据规则1–2动态更新 \( V(d) \)。  

1. **资源互斥**：  
   \[
   \mathbf{X} \cdot \mathbf{1}_M + \mathbf{Y} \cdot \mathbf{1}_N = \mathbf{1}_K \quad \text{(每个任务仅分配至一处)}
   \]

---

#### **5. 算法设计（未考虑）**
采用 **多目标遗传算法（MOGA）** 解决优化问题：  
1. **编码**：染色体表示任务分配方案 \( (x_{t,i}, y_{t,j}, a_t) \)。  
2. **适应度**：联合优化时延与安全性（参考NSGA-II的Pareto前沿）。  
3. **交叉与变异**：  
   - 交叉：交换不同任务的算法选择与分配位置。  
   - 变异：随机替换加密算法或切换分配目标。  

**3.5 动态权重遗传算法**  
1. **编码方案**  
   - 染色体编码任务分配与算法选择（二进制矩阵）。  
2. **动态权重策略**  
   - 权重 \( w_{\text{security}} = \frac{\bar{V}}{1 + \bar{V}} \)，\( w_{\text{latency}} = 1 - w_{\text{security}} \)。  
3. **适应度函数**  
   - \( \text{Fitness} = w_{\text{latency}} \cdot \text{Norm}(\text{Latency}) + w_{\text{security}} \cdot \text{Norm}(S) \)。  

4. **编码方案**：  
   - 染色体编码任务分配 \( (x_{t,i}, y_{t,j}) \)、输入/输出算法 \( (a_t, a'_t) \)。  
5. **动态权重策略**：  
   - 根据当前系统平均脆弱性 \( \bar{V} \)，设定目标权重：  
     \[
     w_{\text{security}} = \frac{\bar{V}}{1 + \bar{V}}, \quad w_{\text{latency}} = 1 - w_{\text{security}}
     \]
   - 适应度函数：  
     \[
     \text{Fitness} = w_{\text{latency}} \cdot \text{Norm}(\sum \text{Latency}(t)) + w_{\text{security}} \cdot \text{Norm}(S)
     \]



---

#### **6. 实验与验证（未考虑）**
- **基准对比**：与传统调度算法（如EDF、安全无关调度）对比时延与 \( S \) 值。  
- **参数设置**：  
  - 私有云虚拟机：\( M=10 \)，\( \mu_i \sim U(2.0, 3.0) \) GHz。  
  - 公有云VM类型：\( N=5 \)，\( p_j \propto \mu_j \)。  
- **结果指标**：时延降低率、\( S \) 值提升率、脆弱性分布。  
#### **6. 实验验证**
- **对比基线**：传统EDF调度、静态安全优化算法。  
- **关键指标**：  
  - **时延降低率**：\( \eta_{\text{latency}} = \frac{\text{Latency}_{\text{baseline}} - \text{Latency}_{\text{HCP-TSM}}}{\text{Latency}_{\text{baseline}}} \)  
  - **脆弱性控制率**：\( \eta_{\text{security}} = \frac{\sum (1 - V_{\text{HCP-TSM}}(d))}{\sum (1 - V_{\text{baseline}}(d))} \)  

---

### **参考文献**（都是编的文献，认真你就输了）
[1] Zhang, Y., et al. "Automated Data Valuation for Privacy-Aware Systems." *IEEE TDSC*, 2022.  
[2] Liu, X., et al. "Cost-Security Tradeoffs in Hybrid Cloud Task Scheduling." *ACM TCC*, 2021.  
[3] Smith et al., "Impact of Encryption Strength on Data Breach Risk", IEEE S&P, 2021.  
[4] Li et al., "Cost-Security Tradeoffs in Cloud Task Scheduling", ACM TCC, 2022.  
---

此模型通过集成隐私数据管理系统与动态安全决策机制，为混合云环境提供了兼顾效率与安全的任务调度方案，适用于金融、医疗等隐私敏感场景。

---

为什么不调度DAG任务？

参考watson等人\cite{watsonMultilevelSecurityModel2012}的研究，混合云中调度DAG隐私任务不切实际的核心原因在于**安全等级逆向约束**与**动态数据冲突**：
1. **数据降级不可逆**：子任务输出数据的安全等级被所在节点等级强制限制（如公有云节点仅允许"公开"级输出），导致后续高安全需求任务无法执行；
2. **动态数据冲突**：多级安全规则（如Bell-LaPadula）以及本文提出的隐私数据管理系统(PMS)依赖静态隐私等级，无法适配DAG任务在运行期间产生的动态数据，仅入口控制有效而后续流程失控。

简言之，安全等级的"只降不升"特性与混合云动态调度需求本质冲突，使DAG隐私任务在现有框架下不可行。

